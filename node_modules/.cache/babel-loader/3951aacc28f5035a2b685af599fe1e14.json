{"ast":null,"code":"'use strict';\n/**\n * References\n * https://xmpp.org/rfcs/rfc6120.html#streams-negotiation Stream Negotiation\n * https://xmpp.org/extensions/xep-0170.html XEP-0170: Recommended Order of Stream Feature Negotiation\n * https://xmpp.org/registrar/stream-features.html XML Stream Features\n */\n\nvar route = require('./route');\n\nmodule.exports = function (_ref) {\n  var middleware = _ref.middleware;\n  middleware.use(route());\n\n  function use(name, xmlns, handler) {\n    return middleware.use(function (ctx, next) {\n      var stanza = ctx.stanza;\n      if (!stanza.is('features', 'http://etherx.jabber.org/streams')) return next();\n      var feature = stanza.getChild(name, xmlns);\n      if (!feature) return next();\n      return handler(ctx, next, feature);\n    });\n  }\n\n  return {\n    use: use\n  };\n};","map":null,"metadata":{},"sourceType":"script"}