{"ast":null,"code":"'use strict';\n\nvar inherits = require('node-xmpp-core').inherits;\n\nvar Mechanism = require('./mechanism');\n/**\n * @see https://developers.google.com/talk/jep_extensions/oauth\n */\n\n\nfunction XOAuth2() {\n  this.oauth2_auth = null;\n  this.authzid = null;\n}\n\ninherits(XOAuth2, Mechanism);\nXOAuth2.prototype.name = 'X-OAUTH2';\nXOAuth2.prototype.NS_GOOGLE_AUTH = 'http://www.google.com/talk/protocol/auth';\n\nXOAuth2.prototype.auth = function () {\n  return '\\0' + this.authzid + '\\0' + this.oauth2_token;\n};\n\nXOAuth2.prototype.authAttrs = function () {\n  return {\n    'auth:service': 'oauth2',\n    'xmlns:auth': this.oauth2_auth\n  };\n};\n\nXOAuth2.prototype.match = function (options) {\n  return options.oauth2_auth === XOAuth2.prototype.NS_GOOGLE_AUTH;\n};\n\nmodule.exports = XOAuth2;","map":null,"metadata":{},"sourceType":"script"}